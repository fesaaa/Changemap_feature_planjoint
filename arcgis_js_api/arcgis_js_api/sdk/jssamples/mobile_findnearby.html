<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="ie lt-ie9 lt-ie8 lt-ie7 ie6"> <![endif]-->
<!--[if IE 7]>         <html class="ie lt-ie9 lt-ie8 ie7"> <![endif]-->
<!--[if IE 8]>         <html class="ie lt-ie9 ie8"> <![endif]-->
<!--[if gt IE 8]><!--> <html> <!--<![endif]-->
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <link rel="stylesheet" href="../styles/screen.css">
  <link rel="stylesheet" href="../styles/homepage.css">
  <link rel="stylesheet" href="../styles/grid.css">
  <link rel="stylesheet" href="../styles/tree.css">
  <link rel="stylesheet" href="../styles/esri-js-api-samples.css">
  <link rel="stylesheet" href="../prettify/prettify.css">
  <style>
    html {
      overflow-y: auto;
    }
    .hidden{
      display: none;
    }
    .switch{
      font-size: 0.8em;
      font-weight: bold;
    }
    .switchWrapper > span.enabled{
      color: #00629b;
      cursor: pointer;
      font-weight: normal;
    }
    .navigation-bar, .section-bar {
      margin-bottom: 0;
    }
    .navigation-bar header h1, .section-bar header h1 {
      margin-top: .35294em;
    }
    .navigation-bar, .section-bar {
      background: url('../graphics/banner.jpg') no-repeat center center #762783;
      min-height: 48px;
      color: white;
    }
    .navigation-bar {
      position: relative;
      z-index: 10;
    }
    #esri-logo {
      background: url('../graphics/logo-esri.png') no-repeat center center ;
      width: 100px;
    }
    @font-face {
    font-family:'icomoon';src:url('../fonts/icons.eot');src:url('../fonts/icons.eot?#iefix') format("embedded-opentype"),url('../fonts/icons.woff') format("woff"),url('../fonts/icons.ttf') format("truetype"),url('../fonts/icons.svg#icomoon') format("svg");font-weight:400;font-style:normal
    }[data-icon]:before {
      font-family: 'icomoon';
      content: attr(data-icon);
      speak: none;
      font-weight: 400;
      line-height: 1;
      -webkit-font-smoothing: antialiased
    }[class*="icon-"]:before {
      font-family: 'icomoon';
      speak: none;
      font-style: normal;
      font-weight: 400;
      line-height: 1;
      -webkit-font-smoothing: antialiased;
      text-transform: none
    }
    pre {
      font-size: 1em;
      line-height: normal;
      margin: 0;
      margin-top: 1em;
    }
    .navigation-bar input {
      margin-top: 0;
      opacity: 1;
    }
    #header nav li a {
      font-size: .875em;
    }
    #esri-logo {
      margin-left: 0;
    }
  </style>
  <!--[if lt IE 9]>
    <script src="../scripts/libs/html5shiv.js"></script>
    <script src="../scripts/libs/selectivizr-min.js"></script>
    <style>
      #wrapper {
        min-width: 960px;
      }
    </style>
  <![endif]-->
  <title>
    Find nearby locations | ArcGIS API for JavaScript
  </title> <!-- sub 1:  insert sample title -->
</head>

<body>
<div id="nav">
<header id="header">
  <div class="container relative-container">
    <div class="header-inner ">
      <div class="logo-wrap"><a href="../" id="site-logo">Arc<span>GIS</span> API for JavaScript</a><!--span class="down-arrow" id="down-arrow"></span--></div>
      <nav id="site-nav" class="">
        <a href="/en/" class="selected">
          <h4 class="developers">Arc<span>GIS</span> API for JavaScript</h4>
          <p>Build location-aware applications with ArcGIS</p>
        </a>

        <a href="https://www.arcgis.com/about/">
          <h4 class="organizations">Arc<span>GIS</span> for Organizations</h4>
          <p>Learn more about ArcGIS</p>
        </a>
      </nav>

      <a id="esri-logo" href="http://esri.com">Esri</a>
      <div id="logged-out-navigation" class="dropdown-navigation hide">
  <a id="login-link" class="btn small light" href="/en/log-in/">Log In</a>
</div>
<div id="logged-in-navigation" class="dropdown-navigation dropdown-wrapper hide">
  <a href="/en/usage-summary" class="dropdown btn small light">
    <!-- <img src="http://d3w50ib5d2uy0g.cloudfront.net/cdn/2464//js/esri/arcgisonline/css/images/no-user-thumb.jpg" width="16" height="16" alt=""> --><span id="username"></span>
  </a>
  <div class="dropdown-content">
    <ul>
      <li><a href="/en/usage-summary/">Usage Summary</a></li>
      <li><a href="/en/applications/">Applications</a></li>
      <li></li>
      <li><a href="/en/tools/">GIS Tools</a></li>
    </ul>
    <hr>
    <ul>
      <li><a href="/en/account/profile/">Account Settings</a></li>
      <li><a href="/en/feedback/">Feedback</a></li>
    </ul>
    <hr>
    <ul>
      <li><a id="log-out-link" href="#">Log Out</a></li>
    </ul>
  </div>
</div>

      <div id="mobile-navigation" class="dropdown-navigation dropdown-wrapper">
        <a href="#" class="dropdown btn small light icon icon-list-2">Select <span>a Section</span></a>
        <div class="dropdown-content">
          <ul>
            <li><a href="../jstutorials/">Tutorials</a></li>
            <li><a href="../jshelp/">Concepts</a></li>
            <li><a href="../jsapi/">API Reference</a></li>
            <li><a href="http://forums.arcgis.com/forums/15">Forum</a></li>
            <li><a href="../../">All Developer Resources</a></li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</header>

<div class="navigation-bar">
  <div class="container">
    <nav>
      
      <div id="section-label"><a href=".">Samples</a></div>
      
      <div id="search">
        <form id="searchForm">
          <input type="text" id="searchKeyWord" name="searchKeyWord" size="30" placeholder="Search the samples" disabled="disabled">
          <!-- <input type="submit" id="searchButton" name="searchButton" value=""> -->
        </form>
      </div>
      <ul>
        <!--li class="current"><a href="/en/javascript/">Home</a></li-->
        <li><a href="../jstutorials/">Tutorials</a></li>
        <li><a href="../jshelp/">Concepts</a></li>
        <li><a href="../jsapi/">API Reference</a></li>
        <li class="current"><a href=".">Samples</a></li>
        <li><a href="http://forums.arcgis.com/forums/15">Forum</a></li>
        <li><a href="../../">All Developer Resources</a></li>
      </ul>
    </nav>
  </div>
</div> 
</div><!-- end nav bar --> <!-- sub 2:  navigation bar -->

<div class="container_12">
  <div class="grid_3 contentWrapper">
    <div id="toggleToc">
      <img src="../graphics/tochide.gif"> Hide Table of Contents
    </div>
    <div id="samplesToc">    <div id="tree" style="top: 35px; left: 0px;" class="treeDiv">
      <div id="treeRoot" onselectstart="return false" ondragstart="return false">
        <div class="treeNode">
          <a href="." class="treeUnselected" onclick="clickAnchor(this)">Samples Overview</a>
        </div>
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Latest Samples
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="renderer_color_ramp.html" class="treeUnselected" onclick="clickAnchor(this)">Color ramp symbols</a>
            </div>
            <div class="treeNode">
              <a href="graphics_create_circles.html" class="treeUnselected" onclick="clickAnchor(this)">Create circles</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Analytics
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="util_buffergraphic.html" class="treeUnselected" onclick="clickAnchor(this)">Buffer any shape</a>
            </div>
            <div class="treeNode">
              <a href="util_measurepoly.html" class="treeUnselected" onclick="clickAnchor(this)">Calculate feature length or area</a>
            </div>
            <div class="treeNode">
              <a href="geoenrichment_infographic.html" class="treeUnselected" onclick="clickAnchor(this)">Geoenrichment - Infographic</a>
            </div>
            <div class="treeNode">
              <a href="geoenrichment_carousel.html" class="treeUnselected" onclick="clickAnchor(this)">Geoenrichment - InfographicsCarousel</a>
            </div>
            <div class="treeNode">
              <a href="gp_resultmapservice.html" class="treeUnselected" onclick="clickAnchor(this)">Geoprocessing with result map service</a>
            </div>
            <div class="treeNode">
              <a href="analysis_hotspot.html" class="treeUnselected" onclick="clickAnchor(this)">Hotspot Analysis</a>
            </div>
            <div class="treeNode">
              <a href="widget_swipe.html" class="treeUnselected" onclick="clickAnchor(this)">LayerSwipe widget</a>
            </div>
            <div class="treeNode">
              <a href="widget_measurement.html" class="treeUnselected" onclick="clickAnchor(this)">Measurement</a>
            </div>
            <div class="treeNode">
              <a href="util_relation.html" class="treeUnselected" onclick="clickAnchor(this)">Point in polygon search</a>
            </div>
            <div class="treeNode">
              <a href="util_label_point.html" class="treeUnselected" onclick="clickAnchor(this)">Points for labeling</a>
            </div>
            <div class="treeNode">
              <a href="gp_zonalstats.html" class="treeUnselected" onclick="clickAnchor(this)">Population zonal statistics</a>
            </div>
            <div class="treeNode">
              <a href="gp_servicearea.html" class="treeUnselected" onclick="clickAnchor(this)">Service area task</a>
            </div>
            <div class="treeNode">
              <a href="analysis_summarizenearby.html" class="treeUnselected" onclick="clickAnchor(this)">Summarize Nearby Analysis</a>
            </div>
            <div class="treeNode">
              <a href="gp_viewshed.html" class="treeUnselected" onclick="clickAnchor(this)">Viewshed</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Directions and Routing
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="routetask_basic_servicearea.html" class="treeUnselected" onclick="clickAnchor(this)">Basic service area</a>
            </div>
            <div class="treeNode">
              <a href="widget_directions_basic.html" class="treeUnselected" onclick="clickAnchor(this)">Directions</a>
            </div>
            <div class="treeNode">
              <a href="routetask_closest_facility.html" class="treeUnselected" onclick="clickAnchor(this)">Find closest facilities</a>
            </div>
            <div class="treeNode">
              <a href="ags_traffic.html" class="treeUnselected" onclick="clickAnchor(this)">World traffic</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Dynamic Layers
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="renderer_dynamic_layer_change_attribute.html" class="treeUnselected" onclick="clickAnchor(this)">Change attribute used for a renderer</a>
            </div>
            <div class="treeNode">
              <a href="renderer_dynamic_layer_class_breaks.html" class="treeUnselected" onclick="clickAnchor(this)">Class breaks renderer with dynamic layer</a>
            </div>
            <div class="treeNode">
              <a href="map_dynamic.html" class="treeUnselected" onclick="clickAnchor(this)">Dynamic map service</a>
            </div>
            <div class="treeNode">
              <a href="map_multiplelayerdef.html" class="treeUnselected" onclick="clickAnchor(this)">Layer definitions on a dynamic map service</a>
            </div>
            <div class="treeNode">
              <a href="layers_dynamic_reorder.html" class="treeUnselected" onclick="clickAnchor(this)">Reorder layers in map service</a>
            </div>
            <div class="treeNode">
              <a href="layers_wmsresourceinfo.html" class="treeUnselected" onclick="clickAnchor(this)">WMS - resource info</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Editing
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="ed_attachments.html" class="treeUnselected" onclick="clickAnchor(this)">Attachment editor</a>
            </div>
            <div class="treeNode">
              <a href="toolbar_draw.html" class="treeUnselected" onclick="clickAnchor(this)">Drawing tools</a>
            </div>
            <div class="treeNode">
              <a href="ed_feature_creation.html" class="treeUnselected" onclick="clickAnchor(this)">Edit without editor widget</a>
            </div>
            <div class="treeNode">
              <a href="toolbar_edit.html" class="treeUnselected" onclick="clickAnchor(this)">Editing tools</a>
            </div>
            <div class="treeNode">
              <a href="ed_simpletoolbar.html" class="treeUnselected" onclick="clickAnchor(this)">Editor widget with simple toolbar</a>
            </div>
            <div class="treeNode">
              <a href="ed_toolbar.html" class="treeUnselected" onclick="clickAnchor(this)">Move and edit vertices</a>
            </div>
            <div class="treeNode">
              <a href="ed_relatededits.html" class="treeUnselected" onclick="clickAnchor(this)">Query and edit related records</a>
            </div>
            <div class="treeNode">
              <a href="ed_template_picker.html" class="treeUnselected" onclick="clickAnchor(this)">Template picker widget</a>
            </div>
            <div class="treeNode">
              <a href="ed_attribute_inspector.html" class="treeUnselected" onclick="clickAnchor(this)">Using the attribute inspector</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Geocoding
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="locator_address.html" class="treeUnselected" onclick="clickAnchor(this)">Geocode an address</a>
            </div>
            <div class="treeNode">
              <a href="locator_details.html" class="treeUnselected" onclick="clickAnchor(this)">Geocode details</a>
            </div>
            <div class="treeNode">
              <a href="locator_simple.html" class="treeUnselected" onclick="clickAnchor(this)">Geocoder</a>
            </div>
            <div class="treeNode">
              <a href="locator_service.html" class="treeUnselected" onclick="clickAnchor(this)">Geocoder with custom service</a>
            </div>
            <div class="treeNode">
              <a href="locator_reverse.html" class="treeUnselected" onclick="clickAnchor(this)">Reverse geocode</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Graphics
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="graphics_add.html" class="treeUnselected" onclick="clickAnchor(this)">Add graphics to a map</a>
            </div>
            <div class="treeNode">
              <a href="graphics_create_circles.html" class="treeUnselected" onclick="clickAnchor(this)">Create circles</a>
            </div>
            <div class="treeNode">
              <a href="graphics_contextmenu.html" class="treeUnselected" onclick="clickAnchor(this)">Display context menu</a>
            </div>
            <div class="treeNode">
              <a href="graphics_undoredo.html" class="treeUnselected" onclick="clickAnchor(this)">Graphics with undo redo</a>
            </div>
            <div class="treeNode">
              <a href="layers_point_clustering.html" class="treeUnselected" onclick="clickAnchor(this)">Point clustering</a>
            </div>
            <div class="treeNode">
              <a href="styling_svg_fb.html" class="treeUnselected" onclick="clickAnchor(this)">SVG and CSS to style polygons</a>
            </div>
            <div class="treeNode">
              <a href="styling_svg_quantize.html" class="treeUnselected" onclick="clickAnchor(this)">SVG and CSS using D3</a>
            </div>
            <div class="treeNode">
              <a href="graphics_svg_path.html" class="treeUnselected" onclick="clickAnchor(this)">SVG path to create a SimpleMarkerSymbol</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            HTML5
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="exp_rasterlayer.html" class="treeUnselected" onclick="clickAnchor(this)">Canvas with raster layer</a>
            </div>
            <div class="treeNode">
              <a href="exp_cors_buffer.html" class="treeUnselected" onclick="clickAnchor(this)">Cross Origin Resource Sharing(CORS) - buffer</a>
            </div>
            <div class="treeNode">
              <a href="exp_dragdrop.html" class="treeUnselected" onclick="clickAnchor(this)">Drag and drop to display data</a>
            </div>
            <div class="treeNode">
              <a href="exp_history.html" class="treeUnselected" onclick="clickAnchor(this)">History API to track selected feature</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Image Layers
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="image_simpleimageservice.html" class="treeUnselected" onclick="clickAnchor(this)">Image service</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Map
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="widget_basemap.html" class="treeUnselected" onclick="clickAnchor(this)">Basemap gallery</a>
            </div>
            <div class="treeNode">
              <a href="widget_toggle.html" class="treeUnselected" onclick="clickAnchor(this)">Basemap Toggle</a>
            </div>
            <div class="treeNode">
              <a href="map_simple.html" class="treeUnselected" onclick="clickAnchor(this)">Create a map</a>
            </div>
            <div class="treeNode">
              <a href="mapconfig_smoothpan.html" class="treeUnselected" onclick="clickAnchor(this)">Customize navigation animation</a>
            </div>
            <div class="treeNode">
              <a href="widget_home.html" class="treeUnselected" onclick="clickAnchor(this)">Home Button</a>
            </div>
            <div class="treeNode">
              <a href="widget_legend.html" class="treeUnselected" onclick="clickAnchor(this)">Legend</a>
            </div>
            <div class="treeNode">
              <a href="widget_locate.html" class="treeUnselected" onclick="clickAnchor(this)">Locate Button</a>
            </div>
            <div class="treeNode">
              <a href="widget_overviewmap.html" class="treeUnselected" onclick="clickAnchor(this)">Overview map</a>
            </div>
            <div class="treeNode">
              <a href="widget_scalebar.html" class="treeUnselected" onclick="clickAnchor(this)">Scalebar</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Maps from ArcGIS.com
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="ags_editor.html" class="treeUnselected" onclick="clickAnchor(this)">Editing layout using map data from ArcGIS.com</a>
            </div>
            <div class="treeNode">
              <a href="ags_fade_webmaps.html" class="treeUnselected" onclick="clickAnchor(this)">Fade effect using ArcGIS.com web maps</a>
            </div>
            <div class="treeNode">
              <a href="widget_gauge_webmap.html" class="treeUnselected" onclick="clickAnchor(this)">Gauges with ArcGIS.com webmap</a>
            </div>
            <div class="treeNode">
              <a href="ags_geodesic_buffers.html" class="treeUnselected" onclick="clickAnchor(this)">Geodesic buffers with ArcGIS.com webmap</a>
            </div>
            <div class="treeNode">
              <a href="ags_createwebmapid.html" class="treeUnselected" onclick="clickAnchor(this)">Web map by ID</a>
            </div>
            <div class="treeNode">
              <a href="ags_createwebmapitem.html" class="treeUnselected" onclick="clickAnchor(this)">Web map using JSON</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Mobile
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="mobile_citizenrequest.html" class="treeUnselected" onclick="clickAnchor(this)">Attribute editing - mobile</a>
            </div>
            <div class="treeNode">
              <a href="mobile_compass.html" class="treeUnselected" onclick="clickAnchor(this)">Compass</a>
            </div>
            <div class="treeNode">
              <a href="mobile_arcgis.html" class="treeUnselected" onclick="clickAnchor(this)">Mobile ArcGIS.com</a>
            </div>
            <div class="treeNode">
              <a href="mobile_shake.html" class="treeUnselected" onclick="clickAnchor(this)">Shake gesture recognition</a>
            </div>
            <div class="treeNode">
              <a href="mobile_soilmap.html" class="treeUnselected" onclick="clickAnchor(this)">Soil details - mobile</a>
            </div>
            <div class="treeNode">
              <a href="mobile_tilt.html" class="treeUnselected" onclick="clickAnchor(this)">Tilt gesture</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Popups and Info Windows
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="widget_extendInfowindow.html" class="treeUnselected" onclick="clickAnchor(this)">Custom info window</a>
            </div>
            <div class="treeNode">
              <a href="widget_formatInfoWindow.html" class="treeUnselected" onclick="clickAnchor(this)">Format info window content</a>
            </div>
            <div class="treeNode">
              <a href="gp_popuplink.html" class="treeUnselected" onclick="clickAnchor(this)">Geoprocessing tool link in popup</a>
            </div>
            <div class="treeNode">
              <a href="widget_infowindow.html" class="treeUnselected" onclick="clickAnchor(this)">Info Window Lite</a>
            </div>
            <div class="treeNode">
              <a href="widget_mobilepopup.html" class="treeUnselected" onclick="clickAnchor(this)">Mobile popup</a>
            </div>
            <div class="treeNode">
              <a href="popup_chart.html" class="treeUnselected" onclick="clickAnchor(this)">Popup</a>
            </div>
            <div class="treeNode">
              <a href="popup_sidepanel.html" class="treeUnselected" onclick="clickAnchor(this)">Popup content in side panel</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Portal
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="portal_addshapefile.html" class="treeUnselected" onclick="clickAnchor(this)">Add shapefile</a>
            </div>
            <div class="treeNode">
              <a href="portal_getgroupamd.html" class="treeUnselected" onclick="clickAnchor(this)">Find group ID</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Printing
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="widget_print.html" class="treeUnselected" onclick="clickAnchor(this)">Print</a>
            </div>
            <div class="treeNode">
              <a href="widget_print_esri_request.html" class="treeUnselected" onclick="clickAnchor(this)">Print templates with esri.request</a>
            </div>
            <div class="treeNode">
              <a href="widget_print_webmap.html" class="treeUnselected" onclick="clickAnchor(this)">Print webmap</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Query and Select
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="fl_hover.html" class="treeUnselected" onclick="clickAnchor(this)">Feature layer hover</a>
            </div>
            <div class="treeNode">
              <a href="query_deferred_list.html" class="treeUnselected" onclick="clickAnchor(this)">Manage results from multiple queries</a>
            </div>
            <div class="treeNode">
              <a href="query_nomap.html" class="treeUnselected" onclick="clickAnchor(this)">Query data without a map</a>
            </div>
            <div class="treeNode">
              <a href="fl_paging.html" class="treeUnselected" onclick="clickAnchor(this)">Query with Feature Layer</a>
            </div>
            <div class="treeNode">
              <a href="query_buffer.html" class="treeUnselected" onclick="clickAnchor(this)">Select with Feature Layer</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Renderers
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="renderer_class_breaks.html" class="treeUnselected" onclick="clickAnchor(this)">Class breaks renderer</a>
            </div>
            <div class="treeNode">
              <a href="renderer_class_breaks_proportional_rotation.html" class="treeUnselected" onclick="clickAnchor(this)">Class breaks with rotation and proportional symbols</a>
            </div>
            <div class="treeNode">
              <a href="renderer_color_ramp.html" class="treeUnselected" onclick="clickAnchor(this)">Color ramp symbols</a>
            </div>
            <div class="treeNode">
              <a href="renderer_dot_density.html" class="treeUnselected" onclick="clickAnchor(this)">Dot density renderer</a>
            </div>
            <div class="treeNode">
              <a href="renderer_generate_renderer.html" class="treeUnselected" onclick="clickAnchor(this)">Generate renderer</a>
            </div>
            <div class="treeNode">
              <a href="renderer_proportional_lines.html" class="treeUnselected" onclick="clickAnchor(this)">Proportional symbols for lines</a>
            </div>
            <div class="treeNode">
              <a href="renderer_proportional_points.html" class="treeUnselected" onclick="clickAnchor(this)">Proportional symbols for points</a>
            </div>
            <div class="treeNode">
              <a href="renderer_function.html" class="treeUnselected" onclick="clickAnchor(this)">Renderer using a function</a>
            </div>
            <div class="treeNode">
              <a href="renderer_proportional_scale_dependent.html" class="treeUnselected" onclick="clickAnchor(this)">Scale dependent renderer</a>
            </div>
            <div class="treeNode">
              <a href="renderer_temporal.html" class="treeUnselected" onclick="clickAnchor(this)">Temporal renderer</a>
            </div>
            <div class="treeNode">
              <a href="renderer_unique_value.html" class="treeUnselected" onclick="clickAnchor(this)">Unique value renderer</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Secure Resources
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="widget_identitymanager_client_side.html" class="treeUnselected" onclick="clickAnchor(this)">Identity Manager with info persisted client side</a>
            </div>
            <div class="treeNode">
              <a href="portal_oauth_inline.html" class="treeUnselected" onclick="clickAnchor(this)">OAuth Basic</a>
            </div>
            <div class="treeNode">
              <a href="portal_oauth_popup.html" class="treeUnselected" onclick="clickAnchor(this)">OAuth Popup</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Tiled Layers
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="layers_ags_tiled.html" class="treeUnselected" onclick="clickAnchor(this)">Tiled map service</a>
            </div>
            <div class="treeNode">
              <a href="layers_webtiled_one.html" class="treeUnselected" onclick="clickAnchor(this)">Web tiled</a>
            </div>
            <div class="treeNode">
              <a href="layers_wmtslayerresourceinfo.html" class="treeUnselected" onclick="clickAnchor(this)">WMTS - resource info</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Time
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="widget_histogram_time_slider.html" class="treeUnselected" onclick="clickAnchor(this)">Histogram Time Slider</a>
            </div>
            <div class="treeNode">
              <a href="time_sliderwithdynamiclayer.html" class="treeUnselected" onclick="clickAnchor(this)">Time slider with dynamic map service layer</a>
            </div>
          </div>
        </div>
        <!--end book-->
        <div class="treeNode">
          <img src="../graphics/treenodeplus.gif" onclick="expandCollapse(this.parentNode)" class="treeLinkImage">
          <span onclick="expandCollapse(this.parentNode)" class="category">
            Vector Feature Layers
          </span>
          <div class="treeSubnodesHidden">
            <div class="treeNode">
              <a href="fl_any_projection.html" class="treeUnselected" onclick="clickAnchor(this)">Any projection</a>
            </div>
            <div class="treeNode">
              <a href="fl_dgrid.html" class="treeUnselected" onclick="clickAnchor(this)">dgrid</a>
            </div>
            <div class="treeNode">
              <a href="fl_featureCollection.html" class="treeUnselected" onclick="clickAnchor(this)">Feature collection</a>
            </div>
            <div class="treeNode">
              <a href="data_gas_prices.html" class="treeUnselected" onclick="clickAnchor(this)">Gas price data by state mashup</a>
            </div>
            <div class="treeNode">
              <a href="layers_georss.html" class="treeUnselected" onclick="clickAnchor(this)">GeoRSS</a>
            </div>
            <div class="treeNode">
              <a href="layers_kml.html" class="treeUnselected" onclick="clickAnchor(this)">KML</a>
            </div>
            <div class="treeNode">
              <a href="layers_kmlbuffer.html" class="treeUnselected" onclick="clickAnchor(this)">KML with buffer</a>
            </div>
            <div class="treeNode">
              <a href="layers_label.html" class="treeUnselected" onclick="clickAnchor(this)">Label Layer</a>
            </div>
            <div class="treeNode">
              <a href="fl_no_basemap.html" class="treeUnselected" onclick="clickAnchor(this)">No basemap</a>
            </div>
            <div class="treeNode">
              <a href="fl_ondemand.html" class="treeUnselected" onclick="clickAnchor(this)">On demand mode</a>
            </div>
            <div class="treeNode">
              <a href="data_requestLayerInfo.html" class="treeUnselected" onclick="clickAnchor(this)">Request layer info</a>
            </div>
            <div class="treeNode">
              <a href="fl_selection.html" class="treeUnselected" onclick="clickAnchor(this)">Select features within a two minute drive time</a>
            </div>
            <div class="treeNode">
              <a href="layers_streamlayer.html" class="treeUnselected" onclick="clickAnchor(this)">Stream Layer</a>
            </div>
            <div class="treeNode">
              <a href="fl_dynamic.html" class="treeUnselected" onclick="clickAnchor(this)">Table source from ArcGIS Server</a>
            </div>
          </div>
        </div>
        <!--end book-->
      </div>
    </div>
</div> <!-- sub 3:  add TOC -->
  </div>
  <div class="grid_9 contentWrapper">
    <div id="samplePane">
      <img class="sampleThumbnail" src="https://devext.arcgis.com/sharing/content/items/f78d4a75643d4bbaafb5bea0b09d7734/info/thumbnail/mobile_findnearby.png" width=200 height=133> <!-- sub 4 -->
      <div id="pageBanner">Find nearby locations</div> <!-- sub 5 -->
      <div id="nstext">
        <H4 class="dtH4 sampleLinks">
          <a href="../samples/mobile_findnearby/" target="_blank">View live sample</a><br> <!-- sub 6 -->
          <a href="http://devext.arcgis.com/sharing/content/items/7600aa76748248e99b00bdd1ec5a0ccb/data">Download as a zip file</a><br> <!-- sub 7 -->
           <!-- sub 8, insert sandbox link, if applicable -->
        </H4>
        <H4 class=dtH4>Description</H4><p style='margin-right: 0em; margin-bottom: 0.5em; margin-left: 0em; color: rgb(0, 0, 0); font-size: 12px; line-height: normal; background-color: rgb(255, 255, 255); '><font face='Verdana, Arial, Helvetica, sans-serif'>This sample uses the </font><a href='http://dev.w3.org/geo/api/spec-source.html' style='font-family: Verdana, Arial, Helvetica, sans-serif; color: rgb(0, 0, 200); '>Geolocation API</a><font face='Verdana, Arial, Helvetica, sans-serif'> to determine the current location. Once the location is discovered, </font><a href='http://developer.yahoo.com/search/local/V3/localSearch.html' style='font-family: Verdana, Arial, Helvetica, sans-serif; color: rgb(0, 0, 200); '>Yahoo's Local Search Web service</a><font face='Verdana, Arial, Helvetica, sans-serif'> is used to find businesses and services near the input location. This code sample uses </font><span style='color: rgb(0, 0, 102); '><font face='Courier New'>esri.request</font></code><font face='Verdana, Arial, Helvetica, sans-serif'> to execute the Yahoo local search and return the results.</font></p><font face='Courier New'><span style='color: rgb(0, 0, 0); '>esri</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>request</code><span style='color: rgb(102, 102, 0); '>({</code><span style='color: rgb(0, 0, 0); '><br />  url</code><span style='color: rgb(102, 102, 0); '>:</code><span style='color: rgb(0, 0, 0); '> </code><span style='color: rgb(153, 153, 153); '>&quot;http://local.yahooapis.com/LocalSearchService/V3/localSearch&quot;</code><span style='color: rgb(102, 102, 0); '>,</code><span style='color: rgb(0, 0, 0); '><br />  content</code><span style='color: rgb(102, 102, 0); '>:</code><span style='color: rgb(0, 0, 0); '> queryParams</code><span style='color: rgb(102, 102, 0); '>,</code><span style='color: rgb(0, 0, 0); '><br />  handleAs</code><span style='color: rgb(102, 102, 0); '>:</code><span style='color: rgb(0, 0, 0); '> </code><span style='color: rgb(153, 153, 153); '>&quot;json&quot;</code><span style='color: rgb(102, 102, 0); '>,</code><span style='color: rgb(0, 0, 0); '><br />  callbackParamName</code><span style='color: rgb(102, 102, 0); '>:</code><span style='color: rgb(153, 153, 153); '>&quot;callback&quot;</code><span style='color: rgb(102, 102, 0); '>,</code><span style='color: rgb(0, 0, 0); '><br />  load</code><span style='color: rgb(102, 102, 0); '>:</code><span style='color: rgb(0, 0, 0); '> buildYahooLocalLocations</code><span style='color: rgb(102, 102, 0); '>,</code><span style='color: rgb(0, 0, 0); '><br />  error</code><span style='color: rgb(102, 102, 0); '>:</code><span style='color: rgb(0, 0, 0); '> esriConfig</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>defaults</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>io</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>errorHandler<br /></code><span style='color: rgb(102, 102, 0); '>});</code></font><p style='margin-right: 0em; margin-bottom: 0.5em; margin-left: 0em; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; background-color: rgb(255, 255, 255); '></p><p style='margin-right: 0em; margin-bottom: 0.5em; margin-left: 0em; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; background-color: rgb(255, 255, 255); '>Details about each result location such as phone number, address, and rating are displayed in a list. The Route Task is then used to generate a route and driving directions from the input location to the selected item.</p><font face='Courier New'><span style='color: rgb(0, 0, 0); '>routeTask</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>solve</code><span style='color: rgb(102, 102, 0); '>(</code><span style='color: rgb(0, 0, 136); '>params</code><span style='color: rgb(102, 102, 0); '>,</code><span style='color: rgb(0, 0, 0); '> </code><span style='color: rgb(0, 0, 136); '>function</code><span style='color: rgb(102, 102, 0); '>(</code><span style='color: rgb(0, 0, 0); '>solveResult</code><span style='color: rgb(102, 102, 0); '>)</code><span style='color: rgb(0, 0, 0); '> </code><span style='color: rgb(102, 102, 0); '>{</code><span style='color: rgb(0, 0, 0); '><br />  </code><span style='color: rgb(0, 0, 136); '>var</code><span style='color: rgb(0, 0, 0); '> directions  </code><span style='color: rgb(102, 102, 0); '>=</code><span style='color: rgb(0, 0, 0); '> solveResult</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>routeResults</code><span style='color: rgb(102, 102, 0); '>[</code><span style='color: rgb(0, 102, 102); '>0</code><span style='color: rgb(102, 102, 0); '>].</code><span style='color: rgb(0, 0, 0); '>directions</code><span style='color: rgb(102, 102, 0); '>;</code><span style='color: rgb(0, 0, 0); '><br />  routeGraphicLayer</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>add</code><span style='color: rgb(102, 102, 0); '>(</code><span style='color: rgb(0, 0, 136); '>new</code><span style='color: rgb(0, 0, 0); '> esri</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>Graphic</code><span style='color: rgb(102, 102, 0); '>(</code><span style='color: rgb(0, 0, 0); '>directions</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>mergedGeometry</code><span style='color: rgb(102, 102, 0); '>));</code><span style='color: rgb(0, 0, 0); '><br />  dojo</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>forEach</code><span style='color: rgb(102, 102, 0); '>(</code><span style='color: rgb(0, 0, 0); '>directions</code><span style='color: rgb(102, 102, 0); '>.</code><span style='color: rgb(0, 0, 0); '>features</code><span style='color: rgb(102, 102, 0); '>,</code><span style='color: rgb(0, 0, 0); '> </code><span style='color: rgb(0, 0, 136); '>function</code><span style='color: rgb(102, 102, 0); '>(</code><span style='color: rgb(0, 0, 0); '>feature</code><span style='color: rgb(102, 102, 0); '>,</code><span style='color: rgb(0, 0, 0); '>index</code><span style='color: rgb(102, 102, 0); '>)</code><span style='color: rgb(0, 0, 0); '> </code><span style='color: rgb(102, 102, 0); '>{</code><span style='color: rgb(0, 0, 0); '><br />    </code><span style='color: rgb(0, 136, 0); '>//do something with the direction information here</code><span style='color: rgb(0, 0, 0); '><br />  </code><span style='color: rgb(102, 102, 0); '>});</code><span style='color: rgb(0, 0, 0); '><br /></code><span style='color: rgb(102, 102, 0); '>});</code></font><p style='margin-right: 0em; margin-bottom: 0.5em; margin-left: 0em; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; background-color: rgb(255, 255, 255); '>This sample uses <a href='http://dojotoolkit.org/documentation/tutorials/1.8/mobile/tweetview/getting_started/' target='_self'>Dojox.mobile</a> to create a user interface that looks and acts like a native iOS application. Dojox.mobile is part of Dojo 1.5 which is included with version 2.1 of the ArcGIS API for JavaScript.</p><p style='margin-right: 0em; margin-bottom: 0.5em; margin-left: 0em; color: rgb(0, 0, 0); font-family: Verdana, Arial, Helvetica, sans-serif; font-size: 12px; line-height: normal; background-color: rgb(255, 255, 255); '>For more details on building web applications for the iPhone operating system view the <a href='http://developer.apple.com/safari/library/referencelibrary/GettingStarted/GS_iPhoneWebApp/index.html#//apple_ref/doc/uid/TP40008134' style='color: rgb(0, 0, 200); '>Safari Reference Library</a>.</p> <!-- sub 9 -->

        <H4 class=dtH4>Code</H4>
        <div class="detailSample">
          <pre class="prettyprint">
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"&gt;
&lt;!-- Sets whether a web application runs in full-screen mode. --&gt;
&lt;meta name="apple-mobile-web-app-capable" content="yes"&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"&gt;
&lt;!-- Sets the style of the status bar for a web application. --&gt;
&lt;meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"&gt;

&lt;title&gt;Find Nearby&lt;/title&gt;

&lt;link type="text/css" rel="stylesheet" href="http://serverapi.arcgisonline.com/jsapi/arcgis/3.4/js/dojo/dojox/mobile/themes/iPhone/iPhone.css"/&gt;
&lt;link rel="stylesheet" type="text/css" href="http://js.arcgis.com/3.8/js/esri/css/esri.css"/&gt;

&lt;style type="text/css"&gt;
  html, body {
    height: 100%;
    margin: 0px;
    padding: 0px;
    width: 100%;
  }
&lt;/style&gt;
&lt;script type="text/javascript"&gt;
  var djConfig = {
    parseOnLoad:true
  };
&lt;/script&gt;

&lt;script type="text/javascript" src="http://js.arcgis.com/3.8compact/"&gt;&lt;/script&gt;

&lt;script language="JavaScript" type="text/javascript"&gt;
dojo.require("esri.tasks.locator");
dojo.require("esri.tasks.route");
dojo.require("dojox.mobile.parser");
dojo.require("dojox.mobile");
dojo.require("dojox.mobile.Button");
dojo.requireIf(!dojo.isWebKit, "dojox.mobile.compat");

var locator, map, currentGraphic;
var searchLocation, currentLocation;
var resultLocationsLayer, routeGraphicLayer, segmentGraphicsLayer;
var routeTask, params, directionFeatures;
var watchProcess;
var progressIndicator;

function init() {
  //onorientationchange doesn't always fire in a timely manner in Android so check for both orientationchange and resize
  var supportsOrientationChange = "onorientationchange" in window, orientationEvent = supportsOrientationChange ? "orientationchange" : "resize";

  window.addEventListener(orientationEvent, function () {
    orientationChanged();
  }, false);

  //Use the Geolocation API to get current location and track it as you move
  if (navigator.geolocation) {
    createProgress('loc');
    var options = {
      timeout:10000
    };
    watchProcess = navigator.geolocation.watchPosition(showLocation, locationError, options);
  } else {
    alert("Geolocation not supported on this device");
    return;
  }
  esri.config.defaults.io.proxyUrl = "/proxy";

  // coffee shops
  /*dojo.connect(dojo.byId('coffeeItem'), 'onclick', function (evt) {
   queryYahoo('coffee');
   });*/
  // bars
  /*dojo.connect(dojo.byId('barItem'), 'onclick', function () {
   queryYahoo('bar');
   });*/
  // ATM machines
  dojo.connect(dojo.byId('atmItem'), 'onclick', function () {
    queryYahoo('atm');
  });
  // Bike shops
  dojo.connect(dojo.byId('bikeItem'), 'onclick', function () {
    queryYahoo('bike');
  });

  map = new esri.Map('map');
  dojo.connect(map, 'onLoad', function (map) {
    //Add graphics layers to display locations and routes
    resultLocationsLayer = new esri.layers.GraphicsLayer();
    map.addLayer(resultLocationsLayer);
    var routePolylineSymbol = new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID, new dojo.Color([115, 44, 123, 0.6]), 4.5);
    var routeRenderer = new esri.renderer.SimpleRenderer(routePolylineSymbol);
    routeGraphicLayer = new esri.layers.GraphicsLayer();
    routeGraphicLayer.setRenderer(routeRenderer);
    map.addLayer(routeGraphicLayer);

    var segmentSymbol = new esri.symbol.SimpleLineSymbol(esri.symbol.SimpleLineSymbol.STYLE_SOLID, new dojo.Color([102, 255, 255, 0.5]), 10);
    var segmentRenderer = new esri.renderer.SimpleRenderer(segmentSymbol);
    segmentGraphicsLayer = new esri.layers.GraphicsLayer();
    segmentGraphicsLayer.setRenderer(segmentRenderer);
    map.addLayer(segmentGraphicsLayer);
  });
  var baseMapLayer = new esri.layers.ArcGISTiledMapServiceLayer('http://server.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer');
  map.addLayer(baseMapLayer);

  //Setup GIS tasks (Route Task and Reverse Geocoding)
  routeTask = new esri.tasks.RouteTask('http://servicesbeta.esri.com/arcgis/rest/services/Network/USA/NAServer/Route');
  locator = new esri.tasks.Locator('http://sampleserver1.arcgisonline.com/ArcGIS/rest/services/Locators/ESRI_Geocode_USA/GeocodeServer');
  params = new esri.tasks.RouteParameters();
  params.stops = new esri.tasks.FeatureSet();
  params.returnRoutes = true;
  params.returnDirections = true;

}

function showLocation(location) {
  var pt = new esri.geometry.Point(location.coords.longitude, location.coords.latitude, new esri.SpatialReference({
    wkid:4326
  }));
  /*
   Geolocation api returns an address but iPhone returns null so use reverse geocoding to get address
   */
  locator.locationToAddress(pt, 200, function (candidate) {
    if (candidate.address) {
      var address = candidate.address.Address + '&lt;br/&gt; ' + candidate.address.City + ', ' + candidate.address.State + ' ' + candidate.address.Zip;
      dojo.byId('loc').innerHTML = address;
      var pt = esri.geometry.geographicToWebMercator(candidate.location);
      dojo.byId('acc').innerHTML = 'Location accurate within ' + location.coords.accuracy + ' meters &lt;br /&gt; Last Updated: ' + new Date(location.timestamp).toLocaleString();
      currentLocation = candidate.location;
      //update the current location icon
      if (!currentGraphic) {
        var symbol = new esri.symbol.PictureMarkerSymbol('images/bluedot.png', 20, 20);
        currentGraphic = new esri.Graphic(pt, symbol);
        map.graphics.add(currentGraphic);
        map.centerAndZoom(pt, 16);
      } else {
        currentGraphic.setGeometry(pt);
      }
      clearProgress();
    }
  }, function (error) {
    dojo.byId('loc').innerHTML = 'Unable to determine address';
    clearProgress();
  });
}

function createProgress(nodeId) {
  //start the progress indicator
  var container = dojo.byId(nodeId);
  container.innerHTML = '';
  progressIndicator = dojox.mobile.ProgressIndicator.getInstance();
  container.appendChild(progressIndicator.domNode);
  progressIndicator.start();
}

function clearProgress() {
  progressIndicator.stop();
}

function locationError(error) {
  switch (error.code) {
    case error.PERMISSION_DENIED:
      alert('Geolocation access denied or disabled. To enable geolocation on your iPhone, go to Settings &gt; General &gt; Location Services');
      //clear the watch if an error occurs
      if (watchProcess != null) {
        navigator.geolocation.clearWatch(watchProcess);
        watchProcess = null;
      }
      break;

    case error.POSITION_UNAVAILABLE:
      alert('Current location not available');
      break;

    case error.TIMEOUT:
      alert('Timeout');
      break;

    default:
      alert('unknown error');
      break;
  }
}

function queryYahoo(queryVal) {
  // console.log('querying');
  // console.log(queryVal);
  createProgress('searchResults');
  var dist = dojo.byId('distVal').innerText.split(' ');
  //Find the closest items of interest using Yahoo Search
  searchLocation = currentLocation;
  var sql = "select * from local.search where latitude='${0}' and longitude='${1}' and radius='${2}' and query='${3}'";
  var vals = [searchLocation.y, searchLocation.x, dist[0], queryVal];
  sql = dojo.string.substitute(sql, vals);
  var queryParams = {
    q:sql,
    format:"json"
  };
  console.log("query params", queryParams);

  esri.request({
    url:'http://query.yahooapis.com/v1/public/yql',
    content:queryParams,
    handleAs:'json',
    callbackParamName:'callback',
    load:buildYahooLocalLocations,
    error:esri.config.defaults.io.errorHandler
  });
}

function buildYahooLocalLocations(response) {
  console.dir(response);
  var itemList = dijit.byId('searchResults');
  //Remove any existing items from the result window
  while (itemList.domNode.hasChildNodes()) {
    itemList.domNode.removeChild(itemList.domNode.lastChild);
  }
  //If no results are found users should increase search distance
  if (response.query.count == 0) {
    var noResults = new dojox.mobile.ListItem({
      label:'No Results'
    });
    noResults.set('class', 'mblVariableHeight');
    noResults.domNode.innerHTML = 'No results found within search radius. Use the settings option to increase the search distance.';
    itemList.addChild(noResults);
    return;
  }
  var results = response.query.results.Result;
  // if (response.query.count == 1) {
  //   results.push(response.ResultSet.Result);
  // } else {
  //   results = response.ResultSet.Result;
  // }
  dojo.forEach(results, function (result) {
    var point = esri.geometry.geographicToWebMercator(new esri.geometry.Point(result.Longitude, result.Latitude));
    //generate the list of results for the result view
    var resultItem = new dojox.mobile.ListItem({
      label:result.Title
    });
    resultItem.set('class', 'mblVariableHeight');
    var content = [];
    if (result.BusinessClickUrl) {
      content.push("&lt;a target='_blank' href='" + result.BusinessClickUrl + "'&gt;" + result.Title + "&lt;/a&gt;&lt;br /&gt;");
    } else {
      content.push(result.Title + '&lt;br /&gt;');
    }
    content.push(result.Address + '&lt;br /&gt;');
    content.push("&lt;a href='tel:" + result.Phone + "'&gt;" + result.Phone + "&lt;/a&gt;&lt;br /&gt;");
    if (!isNaN(result.Rating.AverageRating)) {
      content.push('&lt;b&gt;Average Rating&lt;/b&gt;: ' + result.Rating.AverageRating + '&lt;br /&gt;');
    } else {
      content.push('&lt;b&gt;Average Rating&lt;/b&gt;: No Reviews &lt;br/&gt;');
    }
    content.push(result.Distance + ' miles&lt;br/&gt;');
    var content = content.join('');

    resultItem.domNode.innerHTML = content;
    var button = new dojox.mobile.Button({
      label:'Route',
      moveTo:'mapView'
    }).placeAt(resultItem.domNode);
    var info = {};
    info.lat = result.Latitude;
    info.lon = result.Longitude;
    info.title = result.Title;
    var locationDetails = function (info) {
      return function (results) {
        mapResults(results, info);
      }
    }
    dojo.connect(button, 'onClick', locationDetails(info));
    clearProgress();
    itemList.addChild(resultItem);
  });
}

function mapResults(results, info) {
  //move to the map view to display the route
  var widget = dijit.byId('resultsView');
  widget.performTransition('mapView', 1, 'slide', info, function () {
    map.resize();
    resultLocationsLayer.clear();
    routeGraphicLayer.clear();
    segmentGraphicsLayer.clear();

    //Define the route input parameters
    params.directionsLengthUnits = esri.Units.MILES;
    params.outSpatialReference = map.spatialReference;
    params.stops.features = [];

    //Add the starting location to the map
    var fromSymbol = new esri.symbol.SimpleMarkerSymbol().setColor(new dojo.Color([105, 153, 0]));
    var startLoc = new esri.Graphic(esri.geometry.geographicToWebMercator(new esri.geometry.Point(searchLocation, new esri.SpatialReference({
      wkid:4326
    }))), fromSymbol, {
      Name:dojo.byId('loc').textContent,
      RouteName:info.title
    });
    resultLocationsLayer.add(startLoc);
    params.stops.features[0] = startLoc;

    //Add the ending location to the map
    var toSymbol = new esri.symbol.SimpleMarkerSymbol().setColor(new dojo.Color([204, 0, 0]));
    var endLoc = new esri.Graphic(esri.geometry.geographicToWebMercator(new esri.geometry.Point(info.lon, info.lat, new esri.SpatialReference({
      wkid:4326
    }))), toSymbol, {
      Name:info.title,
      RouteName:info.title
    });
    resultLocationsLayer.add(endLoc);
    params.stops.features[1] = endLoc;

    //Get the Route and display it and the directions on the MapView
    routeTask.solve(params, function (solveResult) {
      var directions = solveResult.routeResults[0].directions;
      directionFeatures = directions.features;
      var content = [];
      content.push('&lt;ol&gt;');
      routeGraphicLayer.add(new esri.Graphic(directions.mergedGeometry));
      dojo.forEach(directions.features, function (feature, index) {
        if (index === 0 || index === directions.features.length - 1) {
          content.push('&lt;li&gt;' + feature.attributes.text + '&lt;/li&gt;');
        } else {
          content.push("&lt;li onclick='zoomToSegment(" + index + "); return false;' class=\"segment\"&gt;&lt;a href=\"#\"&gt;" + feature.attributes.text + "&lt;/a&gt;&lt;/li&gt;");
        }
      });
      content.push("&lt;/ol&gt;");
      dojo.byId("directions").innerHTML = content.join("");
      map.setExtent(directions.extent, true);
    }, function (error) {
      dojo.byId("directions").innerHTML = "&lt;b&gt;Error:&lt;/b&gt; ";
    });
  });
}

function orientationChanged() {
  if (map) {
    map.reposition();
    map.resize();
  }
}

function updateDist(e) {
  console.log('item checked');
  var ul = dojo.byId("searchDistList");
  dojo.forEach(ul.childNodes, function (node) {
    if (!(node.nodeType != 1 || node.tagName != "LI")) {
      var w = dijit.byNode(node);
      if (node === e) {
        dojo.removeClass(w.btnNode, "mblCheckOffButton");
        dojo.addClass(w.btnNode, "mblCheckOnButton");
        dijit.byId("distVal").srcNodeRef.children[0].children[1].textContent = e.children[0].children[0].textContent;
      } else {
        dojo.removeClass(w.btnNode, "mblCheckOnButton");
        dojo.addClass(w.btnNode, "mblCheckOffButton");
      }
    }
  });
}

//Zoom to the appropriate segment afer clicking a hyperlink in the directions list
function zoomToSegment(index) {
  var segment = directionFeatures[index];
  segmentGraphicsLayer.clear();
  var segmentGraphic = new esri.Graphic(segment.geometry);
  segmentGraphicsLayer.add(segmentGraphic);

  map.setExtent(segment.geometry.getExtent(), true);
  //move to the map view
  var widget = dijit.byId('directionsView');
  widget.performTransition('mapView', -1, "fade", null);
}

function getDirections() {
  //switch to the directions view
  var widget = dijit.byId('mapView');
  widget.performTransition('directionsView', 1, "fade", null);
}

dojo.addOnLoad(init);
&lt;/script&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;!-- home view --&gt;
&lt;div id="homeView" data-dojo-type="dojox.mobile.View" selected="true"&gt;
  &lt;h1 data-dojo-type="dojox.mobile.Heading"&gt;What's Nearby&lt;/h1&gt;
  &lt;ul data-dojo-type="dojox.mobile.EdgeToEdgeList" iconBase="images/icons-iphone.png"&gt;
    &lt;li data-dojo-type="dojox.mobile.ListItem" id="coffeeItem" onClick="queryYahoo('coffee');" moveTo="resultsView" iconPos="0,0,32,32" rightText=""&gt;
      Coffee Shops
    &lt;/li&gt;
    &lt;li data-dojo-type="dojox.mobile.ListItem" id="barItem" onClick="queryYahoo('bar');" moveTo="resultsView" iconPos="0,42,32,32" rightText=""&gt;
      Bars
    &lt;/li&gt;
    &lt;li data-dojo-type="dojox.mobile.ListItem" id="atmItem" moveTo="resultsView" iconPos="0,82,32,32" rightText=""&gt;
      ATM
    &lt;/li&gt;
    &lt;li data-dojo-type="dojox.mobile.ListItem" id="bikeItem" moveTo="resultsView" iconPos="0,124,32,32" rightText=""&gt;
      Bike Shops
    &lt;/li&gt;
    &lt;li data-dojo-type="dojox.mobile.ListItem" id="settingsItem" moveTo="settingsView" iconPos="0,166,32,32"&gt;
      Settings
    &lt;/li&gt;
  &lt;/ul&gt;
  &lt;h2 data-dojo-type="dojox.mobile.RoundRectCategory"&gt;Current Location&lt;/h2&gt;
  &lt;div data-dojo-type="dojox.mobile.RoundRect" id="loc"&gt;&lt;/div&gt;
  &lt;div data-dojo-type="dojox.mobile.RoundRect" id="acc"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;!-- map view --&gt;
&lt;div id="mapView" data-dojo-type="dojox.mobile.View" style="width:100%;height:100%;"&gt;
  &lt;h1 data-dojo-type="dojox.mobile.Heading" back="Results" moveTo="resultsView"&gt;Map View&lt;/h1&gt;
  &lt;button id="btnDirections" style="position:absolute;right:5px;top:48px;z-index:99;" data-dojo-type="dojox.mobile.Button" onClick="getDirections();"&gt;
    Directions
  &lt;/button&gt;
  &lt;div style="width:95%;height:95%;" id="map"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;!-- directions view --&gt;
&lt;div id="directionsView" data-dojo-type="dojox.mobile.View"&gt;
  &lt;h1 data-dojo-type="dojox.mobile.Heading" back="Map" moveTo="mapView"&gt;Directions&lt;/h1&gt;
  &lt;div id="directions" data-dojo-type="dojox.mobile.RoundRect" shadow="true"&gt;&lt;/div&gt;
&lt;/div&gt;

&lt;!-- results view --&gt;
&lt;div id="resultsView" data-dojo-type="dojox.mobile.View"&gt;
  &lt;h1 data-dojo-type="dojox.mobile.Heading" back="Main" moveTo="homeView"&gt;Results&lt;/h1&gt;
  &lt;ul id="searchResults" data-dojo-type="dojox.mobile.RoundRectList"&gt;&lt;/ul&gt;
&lt;/div&gt;

&lt;!-- settings view --&gt;
&lt;div id="settingsView" data-dojo-type="dojox.mobile.View"&gt;
  &lt;h1 data-dojo-type="dojox.mobile.Heading" back="Main" moveTo="homeView"&gt;Settings&lt;/h1&gt;
  &lt;ul data-dojo-type="dojox.mobile.RoundRectList"&gt;
    &lt;li id="distVal" data-dojo-type="dojox.mobile.ListItem" moveTo="distView" rightText="2 miles"&gt;
      Search Distance
    &lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;

&lt;!-- distance view --&gt;
&lt;div id="distView" data-dojo-type="dojox.mobile.View"&gt;
  &lt;h1 data-dojo-type="dojox.mobile.Heading" back="Settings" moveTo="settingsView"&gt;Search Distance&lt;/h1&gt;
  &lt;ul data-dojo-type="dojox.mobile.RoundRectList" select="single"&gt;
    &lt;li data-dojo-type="dojox.mobile.ListItem" onClick="updateDist(this);" data-dojo-props='checked:true'&gt;2 miles&lt;/li&gt;
    &lt;li data-dojo-type="dojox.mobile.ListItem" onClick="updateDist(this);"&gt;5 miles&lt;/li&gt;
    &lt;li data-dojo-type="dojox.mobile.ListItem" onClick="updateDist(this);"&gt;10 miles&lt;/li&gt;
  &lt;/ul&gt;
&lt;/div&gt;
&lt;/body&gt;

&lt;/html&gt;
 <!-- sub 10 -->
          </pre>
        </div>
        <br/>
        <br/>
        <div id="wh_footer" class="footnote" align="center">
  Please <a href="mailto:js_feedback@esri.com?subject=Feedback on sample:  mobile_findnearby">contact the team</a> to comment or give suggestions.
  <br>
  Copyright &copy; Environmental Systems Research Institute, Inc.
</div> <!-- sub 11:  feedback markup -->
      </div>
    </div>
  </div>
</div> <!-- end main content -->

<!-- TOC script -->
<script src="../scripts/tree.js"></script>

</script>
<script src="../prettify/prettify.js"></script>
<script>
  var dojoConfig = {
    packages: [{
      "name": "js",
      "location": location.pathname.replace(/\/[^/]+$/, "/") + "../scripts"
    }]
  };
</script>
<script src="//js.arcgis.com/3.8compact/"></script> <!-- add API version -->
<script src="../scripts/esri-main-samples.js"></script>


<!-- google analytics -->
<script>
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-215788-63']);
  _gaq.push(['_setDomainName', 'arcgis.com']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
 <!-- google analytics -->

</body>
</html>
