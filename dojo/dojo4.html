<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="initial-scale=1, maximum-scale=1,user-scalable=no">
    <title>Sample Application</title>
    <link rel="stylesheet" href="/arcgis_js_v22_api/library/3.22/3.22/dijit/themes/claro/claro.css">
    <link rel="stylesheet" href="/arcgis_js_v22_api/library/3.22/3.22/esri/css/esri.css" />

    <link rel="stylesheet" href="css/layout.css"/>

    <script>var dojoConfig = { parseOnLoad: true };</script>
    <script src="/arcgis_js_v22_api/library/3.22/3.22/init.js"></script>
    <script>
	
      dojo.require("dijit.layout.BorderContainer");
      dojo.require("dijit.layout.ContentPane");
      dojo.require("dijit.layout.TabContainer");
	  //dojo.require("dijit.TitlePane");
	  
     var map;
	 var layer;
      require([
			"esri/map",
			"esri/layers/ArcGISTiledMapServiceLayer",
			"esri/layers/ArcGISDynamicMapServiceLayer",
			"esri/geometry/Point",
			"dojo/on",
			"esri/geometry/webMercatorUtils",
			"esri/dijit/Measurement",
			"dojo/domReady!"], 
		function(
			Map,
			ArcGISTiledMapServiceLayer,
			ArcGISDynamicMapServiceLayer,
			Point,
			on,
			webMercatorUtils,
			Measurement,
			domReady)
			{
				map = new Map("mapView",{basemap:"hybrid",center:[102,14],zoom:5,logo:false,sliderPosition:"top-right"});
				
				layer = new ArcGISDynamicMapServiceLayer("http://server.arcgisonline.com/ArcGIS/rest/services/ESRI_StreetMap_World_2D/MapServer");
				map.addLayer(layer);
				layer.hide();
			
        //var measurement = new Measurement({map: map}, dom.byId("measurementDiv"));
        //measurement.startup();

			
			
				map.on("mouse-move", function(evt)
				{	
					/*var screenPoint = new Point(evt.screenX,evt.screenY);
					var mapPoint = new Point();
					mapPoint = map.toMap(screenPoint);
					
					var point = webMercatorUtils.webMercatorToGeographic(mapPoint);
					alert(point.x+","+point.y);*/
					
					var mp = esri.geometry.webMercatorToGeographic(evt.mapPoint);
					var lat = mp.y.toFixed(5);
					var lon = mp.x.toFixed(5);
					document.getElementById("divCoord").innerHTML = "Lon:"+lon+", Lat:"+lat;
				});
      });

	  function toggleLayerStreetMap()
	  {
		if (document.getElementById('chkStreetMap').checked) 
		{
			layer.show();
		} 
		else 
		{
			layer.hide();
		}
	  }
	  
	  function Goto()
	  {
		var lon = document.getElementById('txtLon').value;
		var lat = document.getElementById('txtLat').value;
		
		require([
			  "esri/geometry/Point",
			  "esri/SpatialReference",
			  "dojo/parser",
			  "dojo/dom",
			  "dojo/on",
			  "dojo/domReady!"
			], function(
				  Point,
				  SpatialReference,
				  parser,
				  dom,
				  on
				) 
			{

			if(parseFloat(lat)< -90.0 || parseFloat(lat)> 90.0)
			{
				alert("พิกัดไม่ถูกต้อง");
					return false;
			}
						
			if(parseFloat(lon)< -180.0 || parseFloat(lon)> 180.0)
			{
				alert("พิกัดไม่ถูกต้อง");
				return false;
			}
			
			var location = new Point(parseFloat(lon),parseFloat(lat),new SpatialReference({ wkid:4326 })); 
			map.centerAndZoom(location, map.getLevel());
		
		});
	  }
	  

    </script>
  </head>

  <body class="claro">
    <div id="mainWindow" data-dojo-type="dijit.layout.BorderContainer" data-dojo-props="design:'headline'"
     style="width:100%; height:100%;">

      <div id="header" data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region:'top'">
        <div id="title">
        </div>
      </div>

      <div data-dojo-type="dijit.layout.ContentPane" id="leftPane" data-dojo-props="region:'right'">
        <div data-dojo-type="dijit.layout.TabContainer">
          <div data-dojo-type="dijit.layout.ContentPane" data-dojo-props="title:'Layers', selected:'true'">
			<input type="checkbox" name="chkStreetMap" id="chkStreetMap" onchange="toggleLayerStreetMap()" value="StreetMap"> StreetMap<br>
          </div>
          <div data-dojo-type="dijit.layout.ContentPane" data-dojo-props="title:'Tools'">
            Show Coordinate:<br>
			<div id="divCoord"></div><br><br>
			
			Goto :<br>
			Lon:<input type="text" id="txtLon"><br>
			Lat:<input type="text" id="txtLat"><br>
			<input type="button" value="Goto" onclick="Goto()">


          </div>

        </div>
      </div>
	  
      <div id="mapView" data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region:'center'"></div>
	  
      <div id="footer" data-dojo-type="dijit.layout.ContentPane" data-dojo-props="region:'bottom'">
        <span id="dataSource">
        </span>
      </div>

    </div>
  </body>

</html>
